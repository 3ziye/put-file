<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>put-file - æ–‡ä»¶ä¸Šä¼ æœåŠ¡å™¨</title>
    <style>
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3a0ca3;
            --success-color: #4cc9f0;
            --background-color: #f8f9fa;
            --card-color: #ffffff;
            --text-color: #333333;
            --text-light: #6c757d;
            --border-color: #e9ecef;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 10px 25px rgba(67, 97, 238, 0.15);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            width: 100%;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px 0;
            position: relative;
        }
        
        .logo {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            color: var(--text-light);
            font-size: 1.1rem;
            margin-bottom: 20px;
        }
        
        .card {
            background-color: var(--card-color);
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 30px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }
        
        .upload-section {
            margin-bottom: 30px;
        }
        
        .upload-header {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .upload-header h2 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .upload-header p {
            color: var(--text-light);
            font-size: 0.95rem;
        }
        
        .drop-area {
            border: 2px dashed var(--border-color);
            border-radius: 10px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 20px;
            background-color: rgba(67, 97, 238, 0.05);
        }
        
        .drop-area:hover,
        .drop-area.active {
            border-color: var(--primary-color);
            background-color: rgba(67, 97, 238, 0.1);
        }
        
        .drop-area-icon {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            opacity: 0.7;
        }
        
        .drop-area-text {
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .drop-area-subtext {
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        #file-input {
            display: none;
        }
        
        .browse-btn {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-weight: 500;
            text-decoration: none;
        }
        
        .browse-btn:hover {
            background-color: var(--secondary-color);
        }
        
        .submit-btn {
            width: 100%;
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        .submit-btn:hover {
            background-color: var(--secondary-color);
        }
        
        .file-info {
            display: none;
            margin-top: 15px;
            padding: 10px;
            background-color: rgba(76, 201, 240, 0.1);
            border-radius: 6px;
            border-left: 4px solid var(--success-color);
        }
        
        .file-name {
            font-weight: 500;
            color: var(--primary-color);
        }
        
        .supported-files {
            margin-top: 20px;
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.02);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        
        .supported-files h4 {
            margin-bottom: 8px;
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        .file-types {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }
        
        .file-type-tag {
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary-color);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
        }
        
        .features {
            margin-top: 40px;
        }
        
        .features h3 {
            text-align: center;
            margin-bottom: 25px;
            color: var(--primary-color);
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .feature-item {
            text-align: center;
            padding: 20px;
            background-color: var(--card-color);
            border-radius: 10px;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
        }
        
        .feature-item:hover {
            transform: translateY(-5px);
        }
        
        .feature-icon {
            font-size: 2rem;
            margin-bottom: 15px;
            color: var(--primary-color);
        }
        
        .feature-title {
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .feature-description {
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        .organization-info {
            margin-top: 40px;
            padding: 25px;
            background-color: var(--card-color);
            border-radius: 12px;
            box-shadow: var(--shadow);
            text-align: center;
        }
        
        .organization-info h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .organization-info p {
            margin-bottom: 15px;
            color: var(--text-light);
        }
        
        .github-link {
            display: inline-block;
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }
        
        .github-link:hover {
            color: var(--secondary-color);
            text-decoration: underline;
        }
        
        footer {
            text-align: center;
            margin-top: auto;
            padding: 20px;
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        .message {
            margin-top: 20px;
            padding: 12px;
            border-radius: 6px;
            display: none;
        }
        
        .message.success {
            background-color: rgba(76, 201, 240, 0.15);
            color: #006400;
            border-left: 4px solid var(--success-color);
            display: block;
        }
        
        .message.error {
            background-color: rgba(248, 113, 113, 0.15);
            color: #dc2626;
            border-left: 4px solid #f87171;
            display: block;
        }
        
        /* è®¤è¯åŒºåŸŸæ ·å¼ */
        #auth-section {
            background-color: var(--card-color);
            padding: 20px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            text-align: center;
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        
        /* æœªè®¤è¯æ—¶éšè—æ“ä½œåŒºåŸŸ */
        .require-auth {
            display: none;
        }
        
        /* å·²è®¤è¯æ—¶æ˜¾ç¤ºæ“ä½œåŒºåŸŸ */
        .authenticated .require-auth {
            display: block;
        }
        
        /* å·²è®¤è¯æ—¶éšè—è®¤è¯åŒºåŸŸ */
        .authenticated #auth-section {
            display: none;
        }
        
        #auth-section .auth-header {
            margin-bottom: 20px;
        }
        
        #auth-section .auth-header h2 {
            color: var(--primary-color);
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        #auth-section .auth-header p {
            color: var(--text-light);
            font-size: 0.95rem;
        }
        
        #auth-form {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        #auth-section .auth-input {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 1rem;
            width: 200px;
        }
        
        /* Global auth button style (used by header and auth area) */
        .auth-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 14px;
            border-radius: 10px;
            font-size: 0.95rem;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 6px 14px rgba(67, 97, 238, 0.12);
            transition: transform 0.12s ease, box-shadow 0.12s ease, background-color 0.12s ease;
        }

        .auth-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 30px rgba(67, 97, 238, 0.16);
            background-color: var(--secondary-color);
        }

        /* Header logout specific placement */
        #header-logout-btn {
            position: absolute;
            right: 120px;
            top: 22px;
            display: none; /* toggled by JS */
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
        }
        
        /* Language selector styles */
        .language-selector {
            position: absolute;
            right: 20px;
            top: 22px;
            display: flex;
            gap: 5px;
        }
        
        .language-btn {
            background-color: transparent;
            color: var(--text-color);
            border: 1px solid var(--border-color);
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .language-btn:hover {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        .language-btn.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* Keep auth area logout slightly different if needed */
        #logout-btn {
            display: none; /* toggled by JS */
        }
        
        #auth-section .auth-status {
            display: inline-block;
            margin-top: 10px;
            font-size: 0.9rem;
            color: var(--text-light);
        }
        
        #auth-section .auth-status.authenticated {
            color: var(--success-color);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 0 15px;
            }
            
            #auth-form {
                flex-direction: column;
            }
            
            #auth-section .auth-input {
                width: 100%;
                max-width: 250px;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="main-container">
        <header>
            <div class="logo">put-file</div>
            <p class="subtitle">ç®€å•é«˜æ•ˆçš„æ–‡ä»¶ä¸Šä¼ ä¸åˆ†äº«æœåŠ¡å™¨</p>
            <button id="header-logout-btn" class="auth-btn" style="margin-left: 10px; display: none;">é€€å‡º</button>
            <div class="language-selector">
                <button id="lang-zh" class="language-btn active">ä¸­æ–‡</button>
                <button id="lang-en" class="language-btn">English</button>
            </div>
        </header>
        
        <!-- ç®€åŒ–çš„åŠŸèƒ½ç‰¹ç‚¹ -->
        <div class="simple-features" style="margin-bottom: 20px; font-size: 0.9rem; color: var(--text-light);">
            <div style="display: flex; justify-content: center; gap: 30px;">
                <span>âš¡ å¿«é€Ÿä¸Šä¼ </span>
                <span>ğŸ”’ å®‰å…¨å¯é </span>
                <span>ğŸŒ æ˜“äºè®¿é—®</span>
            </div>
        </div>
        
        <!-- è®¤è¯åŒºåŸŸ -->
        <div id="auth-section">
            <div class="auth-header">
                <h2>å®‰å…¨è®¤è¯</h2>
                <p>è¯·è¾“å…¥å‡­æ®ä»¥ç»§ç»­æ“ä½œ</p>
            </div>
            <form id="auth-form">
                <div style="margin-bottom: 15px;width: 120px;">
                    <label for="auth-username" style="display: block; margin-bottom: 5px; color: var(--text-light);">ç”¨æˆ·å</label>
                    <input style="width: 120px;" type="text" id="auth-username" class="auth-input" value="admin" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" required>
                </div>
                <div style="margin-bottom: 15px;">
                    <label for="auth-password" style="display: block; margin-bottom: 5px; color: var(--text-light);">å¯†ç </label>
                    <input type="password" id="auth-password" class="auth-input" placeholder="è¯·è¾“å…¥å¯†ç " required>
                </div>
                <div>
                    <label style="display: flex; align-items: center; cursor: pointer;">
                        <input type="checkbox" id="remember-me" style="margin-right: 8px; cursor: pointer;">
                        <span style="color: var(--text-light);">è®°ä½(24h)</span>
                    </label>
                </div>
                <br></br>
                <button type="submit" class="auth-btn">ç™»å½•</button>
            </form>
            <div id="auth-status" class="auth-status" style="margin-top: 15px; font-size: 0.9rem; display: flex; align-items: center; justify-content: center;">
                <span id="status-text">æœªè®¤è¯</span>
                <span id="current-user" style="margin-left: 10px; color: var(--accent); display: none;"></span>
                <span id="auth-expires" style="margin-left: 10px; font-size: 0.8rem; color: var(--text-light); display: none;"></span>
            </div>
            <button id="logout-btn" class="auth-btn" style="margin-top: 10px; background-color: #6c757d; display: none;">é€€å‡ºç™»å½•</button>
        </div>

        <div class="card require-auth">
            <div class="upload-section">
                <div class="upload-header">
                    <h2>ä¸Šä¼ æ–‡ä»¶</h2>
                    <p>æ‹–æ‹½æ–‡ä»¶åˆ°ä¸‹æ–¹åŒºåŸŸæˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶</p>
                </div>
                
                <form action="/upload" method="post" enctype="multipart/form-data" id="upload-form">
                    <div class="drop-area" id="drop-area">
                        <div class="drop-area-icon">ğŸ“</div>
                        <div class="drop-area-text">å°†æ–‡ä»¶æ‹–æ”¾åˆ°æ­¤å¤„</div>
                        <div class="drop-area-subtext">æˆ–è€…</div>
                        <label for="file-input" class="browse-btn">æµè§ˆæ–‡ä»¶</label>
                        <input type="file" id="file-input" name="file" required>
                    </div>
                    
                    <div class="file-info" id="file-info">
                        å·²é€‰æ‹©æ–‡ä»¶: <span class="file-name" id="file-name"></span>
                    </div>
                    
                    <button type="submit" class="submit-btn">ä¸Šä¼ æ–‡ä»¶</button>
                </form>
                
                <div class="supported-files">
                    <h4>æ”¯æŒçš„æ–‡ä»¶ç±»å‹:</h4>
                    <div class="file-types">
                        <span class="file-type-tag">PDF</span>
                        <span class="file-type-tag">DOC/DOCX</span>
                        <span class="file-type-tag">JPG/JPEG</span>
                        <span class="file-type-tag">PNG</span>
                        <span class="file-type-tag">GIF</span>
                        <span class="file-type-tag">TXT</span>
                        <span class="file-type-tag">MD</span>
                        <span class="file-type-tag">HTML/CSS/JS</span>
                        <span class="file-type-tag">JSON/XML</span>
                        <span class="file-type-tag">ZIP/RAR/TAR/GZ</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card require-auth">
            <div class="upload-header">
                <h2>æ–‡ä»¶åˆ—è¡¨</h2>
                <p>å·²ä¸Šä¼ çš„æ–‡ä»¶å°†æ˜¾ç¤ºåœ¨æ­¤å¤„</p>
            </div>
            
            <div id="file-list-container">
                <div id="loading-indicator" style="text-align: center; padding: 20px; color: var(--text-light); display: none;">
                    æ­£åœ¨åŠ è½½æ–‡ä»¶åˆ—è¡¨...
                </div>
                
                <div id="no-files" style="text-align: center; padding: 20px; color: var(--text-light); display: none;">
                    æš‚æ— ä¸Šä¼ æ–‡ä»¶
                </div>
                
                <table id="file-table" style="width: 100%; border-collapse: collapse; margin-top: 20px; display: none;">
                    <thead>
                        <tr>
                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color); background-color: rgba(67, 97, 238, 0.05);">æ–‡ä»¶å</th>
                            <th style="padding: 10px; text-align: right; border-bottom: 2px solid var(--border-color); background-color: rgba(67, 97, 238, 0.05);">å¤§å°</th>
                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color); background-color: rgba(67, 97, 238, 0.05);">ä¸Šä¼ æ—¶é—´</th>
                            <th style="padding: 10px; text-align: center; border-bottom: 2px solid var(--border-color); background-color: rgba(67, 97, 238, 0.05);">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="file-list-body">
                        <!-- æ–‡ä»¶åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <footer>
        <p>Â© 2025 <a href="https://github.com/3ziye/put-file" target="_blank" style="color: var(--primary-color); text-decoration: none;">put-file</a> - ç”±3ziyeå¼€æºç»„ç»‡æä¾›æ”¯æŒ</p>
    </footer>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Language support
            const languages = {
                zh: {
                    subtitle: 'ç®€å•é«˜æ•ˆçš„æ–‡ä»¶ä¸Šä¼ ä¸åˆ†äº«æœåŠ¡å™¨',
                    quickFeatures: ['âš¡ å¿«é€Ÿä¸Šä¼ ', 'ğŸ”’ å®‰å…¨å¯é ', 'ğŸŒ æ˜“äºè®¿é—®'],
                    authHeaderTitle: 'å®‰å…¨è®¤è¯',
                    authHeaderDesc: 'è¯·è¾“å…¥å‡­æ®ä»¥ç»§ç»­æ“ä½œ',
                    usernameLabel: 'ç”¨æˆ·å',
                    usernamePlaceholder: 'è¯·è¾“å…¥ç”¨æˆ·å',
                    passwordLabel: 'å¯†ç ',
                    passwordPlaceholder: 'è¯·è¾“å…¥å¯†ç ',
                    rememberMe: 'è®°ä½(24h)',
                    loginBtn: 'ç™»å½•',
                    logoutBtn: 'é€€å‡º',
                    statusUnauthenticated: 'æœªè®¤è¯',
                    statusAuthenticated: 'å·²è®¤è¯',
                    uploadSectionTitle: 'ä¸Šä¼ æ–‡ä»¶',
                    uploadSectionDesc: 'æ‹–æ‹½æ–‡ä»¶åˆ°ä¸‹æ–¹åŒºåŸŸæˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶',
                    dropAreaText: 'å°†æ–‡ä»¶æ‹–æ”¾åˆ°æ­¤å¤„',
                    dropAreaSubtext: 'æˆ–è€…',
                    browseBtn: 'æµè§ˆæ–‡ä»¶',
                    fileInfoText: 'å·²é€‰æ‹©æ–‡ä»¶: ',
                    submitBtn: 'ä¸Šä¼ æ–‡ä»¶',
                    supportedFilesTitle: 'æ”¯æŒçš„æ–‡ä»¶ç±»å‹:',
                    fileListSectionTitle: 'æ–‡ä»¶åˆ—è¡¨',
                    fileListSectionDesc: 'å·²ä¸Šä¼ çš„æ–‡ä»¶å°†æ˜¾ç¤ºåœ¨æ­¤å¤„',
                    loadingFiles: 'æ­£åœ¨åŠ è½½æ–‡ä»¶åˆ—è¡¨...',
                    noFiles: 'æš‚æ— ä¸Šä¼ æ–‡ä»¶',
                    tableHeaders: ['æ–‡ä»¶å', 'å¤§å°', 'ä¸Šä¼ æ—¶é—´', 'æ“ä½œ'],
                    openBtn: 'æ‰“å¼€',
                    deleteBtn: 'åˆ é™¤',
                    deleteConfirm: 'ç¡®å®šè¦åˆ é™¤æ–‡ä»¶"{fileName}"å—ï¼Ÿ',
                    footerText: 'Â© 2025 put-file - ç”±3ziyeå¼€æºç»„ç»‡æä¾›æ”¯æŒ',
                    // æ–°çš„ç¿»è¯‘é¡¹
                    username: 'ç”¨æˆ·å',
                    password: 'å¯†ç ',
                    uploading: 'ä¸Šä¼ ä¸­...',
                    networkErrorPleaseRetry: 'ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•',
                    uploadSuccessButParseFailed: 'æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œä½†è§£æå“åº”å¤±è´¥',
                    confirmDeleteFile: 'ç¡®å®šè¦åˆ é™¤æ–‡ä»¶"{fileName}"å—ï¼Ÿ',
                    fetchFileListFailed: 'è·å–æ–‡ä»¶åˆ—è¡¨å¤±è´¥',
                    loadFileListFailed: 'åŠ è½½æ–‡ä»¶åˆ—è¡¨å¤±è´¥',
                    fileDeleteFailed: 'åˆ é™¤æ–‡ä»¶å¤±è´¥',
                    pleaseAuthenticateToViewFiles: 'è¯·å…ˆè¿›è¡Œè®¤è¯ä»¥æŸ¥çœ‹æ–‡ä»¶åˆ—è¡¨',
                    notSupportedFileType: 'ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹',
                    pleaseSelectFile: 'è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶',
                    pleaseAuthenticateFirst: 'è¯·å…ˆè¿›è¡Œè®¤è¯',
                    authFailedPleaseLogin: 'è®¤è¯å¤±è´¥ï¼Œè¯·é‡æ–°ç™»å½•',
                    uploadSuccess: 'æ–‡ä»¶ä¸Šä¼ æˆåŠŸ',
                    uploadFailed: 'ä¸Šä¼ å¤±è´¥',
                    invalidAuthPleaseLogin: 'è®¤è¯ä¿¡æ¯æ— æ•ˆï¼Œè¯·é‡æ–°ç™»å½•',
                    fileDeleteSuccess: 'æ–‡ä»¶åˆ é™¤æˆåŠŸ',
                    messages: {
                        loggedOut: 'å·²é€€å‡ºç™»å½•',
                        authSuccess: 'è®¤è¯æˆåŠŸ',
                        authFailed: 'ç™»å½•å¤±è´¥ï¼šç”¨æˆ·åæˆ–å¯†ç é”™è¯¯',
                        networkError: 'ç™»å½•å¤±è´¥ï¼šç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•',
                        enterPassword: 'è¯·è¾“å…¥å¯†ç ',
                        unsupportedFileType: 'ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹',
                        selectFile: 'è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶',
                        pleaseAuthenticate: 'è¯·å…ˆè¿›è¡Œè®¤è¯',
                        fileUploadSuccess: 'æ–‡ä»¶ä¸Šä¼ æˆåŠŸ',
                        authExpired: 'è®¤è¯å¤±è´¥ï¼Œè¯·é‡æ–°ç™»å½•',
                        uploadFailed: 'ä¸Šä¼ å¤±è´¥',
                        fileDeleteSuccess: 'æ–‡ä»¶åˆ é™¤æˆåŠŸ',
                        deleteFailed: 'åˆ é™¤æ–‡ä»¶å¤±è´¥: ',
                        invalidAuth: 'è®¤è¯ä¿¡æ¯æ— æ•ˆï¼Œè¯·é‡æ–°ç™»å½•',
                        loadingFailed: 'åŠ è½½æ–‡ä»¶åˆ—è¡¨å¤±è´¥: '
                    }
                },
                en: {
                    subtitle: 'Simple and efficient file upload and sharing server',
                    quickFeatures: ['âš¡ Fast Upload', 'ğŸ”’ Secure', 'ğŸŒ Easy Access'],
                    authHeaderTitle: 'Secure Authentication',
                    authHeaderDesc: 'Please enter your credentials to continue',
                    usernameLabel: 'Username',
                    usernamePlaceholder: 'Enter username',
                    passwordLabel: 'Password',
                    passwordPlaceholder: 'Enter password',
                    rememberMe: 'Remember (24h)',
                    loginBtn: 'Login',
                    logoutBtn: 'Logout',
                    statusUnauthenticated: 'Unauthenticated',
                    statusAuthenticated: 'Authenticated',
                    uploadSectionTitle: 'Upload File',
                    uploadSectionDesc: 'Drag and drop files to the area below or click to select files',
                    dropAreaText: 'Drop files here',
                    dropAreaSubtext: 'or',
                    browseBtn: 'Browse Files',
                    fileInfoText: 'Selected file: ',
                    submitBtn: 'Upload File',
                    supportedFilesTitle: 'Supported file types:',
                    fileListSectionTitle: 'File List',
                    fileListSectionDesc: 'Uploaded files will be displayed here',
                    loadingFiles: 'Loading file list...',
                    noFiles: 'No uploaded files yet',
                    tableHeaders: ['File Name', 'Size', 'Upload Time', 'Actions'],
                    openBtn: 'Open',
                    deleteBtn: 'Delete',
                    deleteConfirm: 'Are you sure you want to delete file "{fileName}"?',
                    footerText: 'Â© 2025 put-file - Supported by 3ziye Open Source Organization',
                    // æ–°çš„ç¿»è¯‘é¡¹
                    username: 'Username',
                    password: 'Password',
                    uploading: 'Uploading...',
                    networkErrorPleaseRetry: 'Network error, please try again later',
                    uploadSuccessButParseFailed: 'File uploaded successfully, but failed to parse response',
                    confirmDeleteFile: 'Are you sure you want to delete file "{fileName}"?',
                    fetchFileListFailed: 'Failed to fetch file list',
                    loadFileListFailed: 'Failed to load file list',
                    fileDeleteFailed: 'Failed to delete file',
                    pleaseAuthenticateToViewFiles: 'Please authenticate first to view file list',
                    notSupportedFileType: 'Unsupported file type',
                    pleaseSelectFile: 'Please select a file to upload',
                    pleaseAuthenticateFirst: 'Please authenticate first',
                    authFailedPleaseLogin: 'Authentication failed, please login again',
                    uploadSuccess: 'File uploaded successfully',
                    uploadFailed: 'Upload failed',
                    invalidAuthPleaseLogin: 'Invalid authentication, please login again',
                    fileDeleteSuccess: 'File deleted successfully',
                    messages: {
                        loggedOut: 'Logged out successfully',
                        authSuccess: 'Authentication successful',
                        authFailed: 'Login failed: Incorrect username or password',
                        networkError: 'Login failed: Network error, please try again later',
                        enterPassword: 'Please enter password',
                        unsupportedFileType: 'Unsupported file type',
                        selectFile: 'Please select a file to upload',
                        pleaseAuthenticate: 'Please authenticate first',
                        fileUploadSuccess: 'File uploaded successfully',
                        authExpired: 'Authentication failed, please login again',
                        uploadFailed: 'Upload failed',
                        fileDeleteSuccess: 'File deleted successfully',
                        deleteFailed: 'Failed to delete file: ',
                        invalidAuth: 'Invalid authentication information, please login again',
                        loadingFailed: 'Failed to load file list: '
                    }
                }
            };
            
            // Current language
            let currentLang = localStorage.getItem('put-file-language') || 'zh';
            
            // Current language pack
            let langPack = languages[currentLang];
            
            // Function to switch language
            function switchLanguage(lang) {
                if (!languages[lang]) return;
                
                currentLang = lang;
                localStorage.setItem('put-file-language', lang);
                
                // Update language buttons
                document.getElementById('lang-zh').classList.toggle('active', lang === 'zh');
                document.getElementById('lang-en').classList.toggle('active', lang === 'en');
                
                // Update HTML lang attribute
                document.documentElement.lang = lang;
                
                // Update text content and langPack
                const translations = languages[lang];
                langPack = translations;
                
                // Update subtitle
                document.querySelector('.subtitle').textContent = translations.subtitle;
                
                // Update quick features
                const quickFeatures = document.querySelector('.simple-features');
                if (quickFeatures) {
                    const featuresDiv = quickFeatures.querySelector('div');
                    if (featuresDiv) {
                        featuresDiv.innerHTML = '';
                        translations.quickFeatures.forEach((feature, index) => {
                            const span = document.createElement('span');
                            span.textContent = feature;
                            if (index < translations.quickFeatures.length - 1) {
                                span.style.marginRight = '30px';
                            }
                            featuresDiv.appendChild(span);
                        });
                    }
                }
                
                // Update auth section
                const authHeader = document.querySelector('#auth-section .auth-header h2');
                if (authHeader) authHeader.textContent = translations.authHeaderTitle;
                
                const authHeaderDesc = document.querySelector('#auth-section .auth-header p');
                if (authHeaderDesc) authHeaderDesc.textContent = translations.authHeaderDesc;
                
                const usernameLabel = document.querySelector('label[for="auth-username"]');
                if (usernameLabel) usernameLabel.textContent = translations.usernameLabel;
                
                const authUsername = document.getElementById('auth-username');
                if (authUsername) authUsername.placeholder = translations.usernamePlaceholder;
                
                const passwordLabel = document.querySelector('label[for="auth-password"]');
                if (passwordLabel) passwordLabel.textContent = translations.passwordLabel;
                
                const authPassword = document.getElementById('auth-password');
                if (authPassword) authPassword.placeholder = translations.passwordPlaceholder;
                
                const rememberMeLabel = document.querySelector('label[for="remember-me"] span');
                if (rememberMeLabel) rememberMeLabel.textContent = translations.rememberMe;
                
                const loginBtn = document.querySelector('#auth-form button[type="submit"]');
                if (loginBtn) loginBtn.textContent = translations.loginBtn;
                
                // Update logout buttons
                const logoutBtns = document.querySelectorAll('.auth-btn:not(#logout-btn)');
                logoutBtns.forEach(btn => {
                    if (btn.textContent === 'é€€å‡º') btn.textContent = translations.logoutBtn;
                });
                
                const mainLogoutBtn = document.getElementById('logout-btn');
                if (mainLogoutBtn) mainLogoutBtn.textContent = translations.logoutBtn;
                
                // Update upload section
                const uploadHeader = document.querySelector('.upload-section .upload-header h2');
                if (uploadHeader) uploadHeader.textContent = translations.uploadSectionTitle;
                
                const uploadHeaderDesc = document.querySelector('.upload-section .upload-header p');
                if (uploadHeaderDesc) uploadHeaderDesc.textContent = translations.uploadSectionDesc;
                
                const dropAreaText = document.querySelector('.drop-area-text');
                if (dropAreaText) dropAreaText.textContent = translations.dropAreaText;
                
                const dropAreaSubtext = document.querySelector('.drop-area-subtext');
                if (dropAreaSubtext) dropAreaSubtext.textContent = translations.dropAreaSubtext;
                
                const browseBtn = document.querySelector('.browse-btn');
                if (browseBtn) browseBtn.textContent = translations.browseBtn;
                
                const fileInfo = document.querySelector('.file-info');
                if (fileInfo && !fileInfo.classList.contains('dynamic-file-info')) {
                    fileInfo.classList.add('dynamic-file-info');
                    // Store original structure for later updates
                    const originalHTML = fileInfo.innerHTML;
                    fileInfo.dataset.originalHTML = originalHTML;
                }
                
                if (fileInfo && fileInfo.classList.contains('dynamic-file-info') && fileInfo.textContent.includes('å·²é€‰æ‹©æ–‡ä»¶') || fileInfo.textContent.includes('Selected file')) {
                    const fileName = document.getElementById('file-name');
                    if (fileName && fileName.textContent) {
                        fileInfo.innerHTML = translations.fileInfoText + '<span class="file-name" id="file-name">' + fileName.textContent + '</span>';
                    }
                }
                
                const submitBtn = document.querySelector('.submit-btn');
                if (submitBtn) submitBtn.textContent = translations.submitBtn;
                
                const supportedFilesTitle = document.querySelector('.supported-files h4');
                if (supportedFilesTitle) supportedFilesTitle.textContent = translations.supportedFilesTitle;
                
                // Update file list section
                const fileListHeader = document.querySelector('.card.require-auth:nth-of-type(2) .upload-header h2');
                if (fileListHeader) fileListHeader.textContent = translations.fileListSectionTitle;
                
                const fileListHeaderDesc = document.querySelector('.card.require-auth:nth-of-type(2) .upload-header p');
                if (fileListHeaderDesc) fileListHeaderDesc.textContent = translations.fileListSectionDesc;
                
                const loadingIndicator = document.getElementById('loading-indicator');
                if (loadingIndicator) loadingIndicator.textContent = translations.loadingFiles;
                
                const noFiles = document.getElementById('no-files');
                if (noFiles) noFiles.textContent = translations.noFiles;
                
                // Update table headers
                const tableHeaders = document.querySelectorAll('#file-table th');
                if (tableHeaders.length === translations.tableHeaders.length) {
                    tableHeaders.forEach((th, index) => {
                        th.textContent = translations.tableHeaders[index];
                    });
                }
                
                // Update open/delete buttons (this will affect future buttons added dynamically)
                document.querySelectorAll('.open-btn').forEach(btn => {
                    btn.textContent = translations.openBtn;
                });
                
                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.textContent = translations.deleteBtn;
                });
                
                // Update footer
                const footer = document.querySelector('footer p');
                if (footer) {
                    footer.innerHTML = translations.footerText.replace('put-file', '<a href="https://github.com/3ziye/put-file" target="_blank" style="color: var(--primary-color); text-decoration: none;">put-file</a>');
                }
                
                // Update status text if it's not temporary
                const statusText = document.getElementById('status-text');
                if (statusText && !statusText.dataset.temp) {
                    const authCache = JSON.parse(localStorage.getItem('put-fileAuth') || '{}');
                    statusText.textContent = authCache.isAuthenticated ? translations.statusAuthenticated : translations.statusUnauthenticated;
                }
                
                // Update any authentication expired time format
                const authExpires = document.getElementById('auth-expires');
                if (authExpires && authExpires.style.display !== 'none') {
                    const authCache = JSON.parse(localStorage.getItem('put-fileAuth') || '{}');
                    if (authCache.lastAuthenticated) {
                        const expireTime = new Date(authCache.lastAuthenticated + 24 * 60 * 60 * 1000);
                        const timeFormat = lang === 'zh' ? 'zh-CN' : 'en-US';
                        authExpires.textContent = (lang === 'zh' ? 'è¿‡æœŸæ—¶é—´: ' : 'Expires: ') + 
                            expireTime.toLocaleTimeString(timeFormat, {hour: '2-digit', minute:'2-digit'});
                    }
                }
            }
            
            // Initialize language
            switchLanguage(currentLang);
            
            // Add language switch event listeners
            document.getElementById('lang-zh').addEventListener('click', () => switchLanguage('zh'));
            document.getElementById('lang-en').addEventListener('click', () => switchLanguage('en'));
            
            // Override showMessage function to use translations
            const originalShowMessage = window.showMessage;
            window.showMessage = function(message, type = 'info') {
                // Try to translate message if it's a known message key
                const translations = languages[currentLang];
                if (translations && translations.messages && translations.messages[message]) {
                    message = translations.messages[message];
                }
                
                // Call original function
                originalShowMessage(message, type);
            };
            
            const dropArea = document.getElementById('drop-area');
            const fileInput = document.getElementById('file-input');
            const fileInfo = document.getElementById('file-info');
            const fileName = document.getElementById('file-name');
            const uploadForm = document.getElementById('upload-form');
            const authForm = document.getElementById('auth-form');
            const authSection = document.getElementById('auth-section');
            const authStatus = document.getElementById('auth-status');
            
            // è®¤è¯çŠ¶æ€ç®¡ç†
            let authCache = {
                authHeader: null,
                isAuthenticated: false,
                lastAuthenticated: null,
                username: ''
            };

            const logoutBtn = document.getElementById('logout-btn');
            const headerLogoutBtn = document.getElementById('header-logout-btn');
            const authPassword = document.getElementById('auth-password');
            const strengthText = document.getElementById('strength-text');
            const rememberMe = document.getElementById('remember-me');
            const currentUser = document.getElementById('current-user');
            const authExpires = document.getElementById('auth-expires');
            const statusText = document.getElementById('status-text');

            // æ£€æŸ¥æœ¬åœ°å­˜å‚¨ä¸­çš„è®¤è¯ä¿¡æ¯
            const savedAuth = localStorage.getItem('put-fileAuth');
            if (savedAuth) {
                try {
                    const parsed = JSON.parse(savedAuth);
                    const now = new Date().getTime();
                    if (parsed.isAuthenticated && (now - parsed.lastAuthenticated < 24 * 60 * 60 * 1000)) {
                        authCache = parsed;
                        updateAuthStatus();
                    }
                } catch (e) {
                    // å¿½ç•¥è§£æé”™è¯¯
                }
            }

            // æ£€æŸ¥å¯†ç å¼ºåº¦
            function checkPasswordStrength(password) {
                let strength = 0;
                
                // é•¿åº¦æ£€æŸ¥
                if (password.length >= 8) strength++;
                if (password.length >= 12) strength++;
                
                // å¤æ‚åº¦æ£€æŸ¥
                if (/[A-Z]/.test(password)) strength++;
                if (/[a-z]/.test(password)) strength++;
                if (/[0-9]/.test(password)) strength++;
                if (/[^A-Za-z0-9]/.test(password)) strength++;
                
                return strength;
            }

            // æ›´æ–°è®¤è¯çŠ¶æ€æ˜¾ç¤º
            function updateAuthStatus() {
                const mainContainer = document.getElementById('main-container');
                
                if (authCache.isAuthenticated) {
                    // å¦‚æœå½“å‰statusTextè¢«ä¸´æ—¶é”™è¯¯ä¿¡æ¯å ç”¨ï¼ˆç”±showMessageè®¾ç½®ï¼‰ï¼Œåˆ™ä¸è¦è¦†ç›–å®ƒã€‚
                    if (!statusText.dataset.temp) {
                        statusText.textContent = langPack.statusAuthenticated;
                    }
                    authStatus.classList.add('authenticated');
                    mainContainer.classList.add('authenticated');
                    logoutBtn.style.display = 'inline-block';
                    if (headerLogoutBtn) headerLogoutBtn.style.display = 'inline-block';
                    
                    // æ˜¾ç¤ºå½“å‰ç”¨æˆ·å’Œè¿‡æœŸæ—¶é—´
                    if (authCache.username) {
                        currentUser.textContent = authCache.username;
                        currentUser.style.display = 'inline';
                    }
                    
                    // æ˜¾ç¤ºè®¤è¯è¿‡æœŸæ—¶é—´
                    if (authCache.lastAuthenticated) {
                        const expireTime = new Date(authCache.lastAuthenticated + 24 * 60 * 60 * 1000);
                        const timeFormat = currentLang === 'en' ? 'en-US' : 'zh-CN';
                        authExpires.textContent = (currentLang === 'zh' ? 'è¿‡æœŸæ—¶é—´: ' : 'Expires: ') + 
                            expireTime.toLocaleTimeString(timeFormat, {hour: '2-digit', minute:'2-digit'});
                        authExpires.style.display = 'inline';
                    }
                } else {
                    // åŒä¸Šï¼Œåªæœ‰åœ¨æ²¡æœ‰ä¸´æ—¶é”™è¯¯ä¿¡æ¯æ—¶æ‰æ¢å¤ä¸ºé»˜è®¤çš„æœªè®¤è¯çŠ¶æ€
                    if (!statusText.dataset.temp) {
                        statusText.textContent = langPack.statusUnauthenticated;
                    }
                    authStatus.classList.remove('authenticated');
                    mainContainer.classList.remove('authenticated');
                    logoutBtn.style.display = 'none';
                    if (headerLogoutBtn) headerLogoutBtn.style.display = 'none';
                    currentUser.style.display = 'none';
                    authExpires.style.display = 'none';
                }
            }

            // æ‰§è¡Œé€€å‡ºé€»è¾‘çš„é€šç”¨å‡½æ•°
            function performLogout() {
                authCache = {
                    authHeader: null,
                    isAuthenticated: false,
                    lastAuthenticated: null,
                    username: ''
                };

                localStorage.removeItem('put-fileAuth');
                sessionStorage.removeItem('put-fileAuth');
                updateAuthStatus();
                showMessage(langPack.messages.loggedOut, 'info');
            }

            // ç»‘å®šåº•éƒ¨é€€å‡ºæŒ‰é’®
            logoutBtn.addEventListener('click', function() {
                performLogout();
            });

            // ç»‘å®šå¤´éƒ¨é€€å‡ºæŒ‰é’®
            if (headerLogoutBtn) {
                headerLogoutBtn.addEventListener('click', function() {
                    performLogout();
                });
            }

            // æ›´æ–°ç™»å½•çŠ¶æ€æ˜¾ç¤º
            function updateLoginStatusDisplay(isAuthenticated) {
                updateAuthStatus();
            }

            // å¤„ç†è®¤è¯è¡¨å•æäº¤
            authForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('auth-username').value;
                const password = document.getElementById('auth-password').value;
                
                if (password) {
                    // åˆ›å»ºBasicè®¤è¯å¤´
                    const authHeader = 'Basic ' + btoa(username + ':' + password);
                    
                    // å…ˆå‘æœåŠ¡å™¨éªŒè¯å‡­æ®æœ‰æ•ˆæ€§
                    fetch('/api/auth/verify', {
                        method: 'GET',
                        headers: {
                            'Authorization': authHeader
                        }
                    }).then(response => {
                        if (response.ok) {
                            // éªŒè¯æˆåŠŸï¼Œæ›´æ–°è®¤è¯ç¼“å­˜
                            authCache = {
                                authHeader: authHeader,
                                isAuthenticated: true,
                                lastAuthenticated: new Date().getTime(),
                                username: username
                            };
                            
                            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                            if (rememberMe.checked) {
                                localStorage.setItem('put-fileAuth', JSON.stringify(authCache));
                            } else {
                                // å¦‚æœä¸å‹¾é€‰è®°ä½æˆ‘ï¼Œåˆ™ä½¿ç”¨ä¼šè¯å­˜å‚¨
                                sessionStorage.setItem('put-fileAuth', JSON.stringify(authCache));
                                // æ¸…é™¤å¯èƒ½å­˜åœ¨çš„æœ¬åœ°å­˜å‚¨
                                localStorage.removeItem('put-fileAuth');
                            }
                            
                            // æ›´æ–°è®¤è¯çŠ¶æ€
                            updateAuthStatus();

                            // ç™»å½•æˆåŠŸååˆ·æ–°æ–‡ä»¶åˆ—è¡¨
                            loadFileList();

                            // æ¸…ç©ºå¯†ç å­—æ®µ
                            document.getElementById('auth-password').value = '';

                            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                            showMessage(langPack.messages.authSuccess, 'success');
                            
                            // æ— è®ºæ–‡ä»¶åˆ—è¡¨æ˜¯å¦æ­£åœ¨åŠ è½½ï¼Œç™»å½•åéƒ½ç«‹å³åŠ è½½æ–‡ä»¶åˆ—è¡¨
                            loadFileList();
                            
                            // ç™»å½•æˆåŠŸè¿”å›å€¼
                            const loginResult = {
                                success: true,
                                timestamp: new Date().toISOString(),
                                message: langPack.messages.authSuccess,
                                data: {
                                    authenticated: true,
                                    timestamp: authCache.lastAuthenticated,
                                    username: username
                                }
                            };
                            
                            // åœ¨æ§åˆ¶å°è¾“å‡ºè¿”å›å€¼ï¼Œä¾¿äºè°ƒè¯•å’ŒæŸ¥çœ‹
                            console.log('ç™»å½•ç»“æœ:', loginResult);
                            
                            // å¯ä»¥åœ¨å…¨å±€å¯¹è±¡ä¸­è®¾ç½®è¿”å›å€¼ï¼Œä¾¿äºå…¶ä»–è„šæœ¬è·å–
                            window.loginResult = loginResult;
                            
                            // æ·»åŠ æŒä¹…çš„ç™»å½•çŠ¶æ€æ˜¾ç¤º
                            updateLoginStatusDisplay(true);
                            
                        } else {
                            // éªŒè¯å¤±è´¥
                            statusText.textContent = langPack.messages.authFailed;
                            // éªŒè¯å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
                            showMessage(langPack.messages.authFailed, 'error');
                            
                            // ç™»å½•å¤±è´¥è¿”å›å€¼
                            const loginResult = {
                                success: false,
                                timestamp: new Date().toISOString(),
                                message: langPack.messages.authFailed,
                                data: null
                            };
                            
                            console.log('ç™»å½•ç»“æœ:', loginResult);
                            window.loginResult = loginResult;
                            
                            // æ›´æ–°ç™»å½•çŠ¶æ€æ˜¾ç¤º
                            updateLoginStatusDisplay(false);
                        }
                    }).catch(error => {
                        // å¤„ç†ç½‘ç»œæˆ–å…¶ä»–é”™è¯¯
                        statusText.textContent = langPack.messages.networkError;
                        // ç½‘ç»œé”™è¯¯ï¼Œæ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
                        showMessage(langPack.messages.networkError, 'error');
                        console.error('Login error:', error);
                        
                        // ç™»å½•å¤±è´¥è¿”å›å€¼
                        const loginResult = {
                            success: false,
                            timestamp: new Date().toISOString(),
                            message: langPack.messages.networkError,
                            data: null
                        };
                        
                        console.log('ç™»å½•ç»“æœ:', loginResult);
                        window.loginResult = loginResult;
                        
                        // æ›´æ–°ç™»å½•çŠ¶æ€æ˜¾ç¤º
                        updateLoginStatusDisplay(false);
                    });
                } else {
                    // å¯†ç ä¸ºç©ºï¼Œæ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
                    statusText.textContent = langPack.messages.enterPassword;
                    showMessage(langPack.messages.enterPassword, 'error');
                }
            });
            
            // æ‹–æ‹½äº‹ä»¶å¤„ç†
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, preventDefaults, false);
            });
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            ['dragenter', 'dragover'].forEach(eventName => {
                dropArea.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, unhighlight, false);
            });
            
            function highlight() {
                dropArea.classList.add('active');
            }
            
            function unhighlight() {
                dropArea.classList.remove('active');
            }
            
            // å¤„ç†æ–‡ä»¶æ”¾ç½®
            dropArea.addEventListener('drop', handleDrop, false);
            
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                
                if (files.length) {
                    handleFiles(files[0]);
                }
            }
            
            // å¤„ç†æ–‡ä»¶é€‰æ‹©
            fileInput.addEventListener('change', function() {
                if (this.files.length) {
                    handleFiles(this.files[0]);
                }
            });
            
            function handleFiles(file) {
                // ç¡®ä¿æ–‡ä»¶è¾“å…¥å€¼æ­£ç¡®è®¾ç½®
                fileInput.files = fileInput.files || new FileList();
                
                // æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
                fileName.textContent = file.name;
                fileInfo.style.display = 'block';
                
                // æ·»åŠ ä¸€ä¸ªå°åŠ¨ç”»æ•ˆæœæ¥å¼ºè°ƒæ–‡ä»¶è¢«é€‰ä¸­
                fileInfo.style.opacity = '0.7';
                setTimeout(() => {
                    fileInfo.style.opacity = '1';
                }, 200);
                
                // æ£€æŸ¥æ–‡ä»¶ç±»å‹ï¼ˆå‰ç«¯éªŒè¯ï¼Œåç«¯ä¹Ÿä¼šéªŒè¯ï¼‰
                const allowedExtensions = ['pdf', 'doc', 'docx', 'jpg', 'jpeg', 'png', 'gif', 'txt', 'md', 'html', 'css', 'js', 'json', 'xml', 'zip', 'rar', 'tar', 'gz'];
                const extension = file.name.split('.').pop()?.toLowerCase() || '';
                
                if (!extension || !allowedExtensions.includes(extension)) {
                    showMessage(langPack.notSupportedFileType, 'error');
                    fileInput.value = '';
                    fileInfo.style.display = 'none';
                }
            }
            
            // è¡¨å•æäº¤å¤„ç†
            uploadForm.addEventListener('submit', function(e) {
                if (!fileInput.files.length) {
                    e.preventDefault();
                    showMessage(langPack.pleaseSelectFile, 'error');
                    return;
                }
                
                if (!authCache.isAuthenticated) {
                    e.preventDefault();
                    showMessage(langPack.pleaseAuthenticateFirst, 'error');
                    // æ»šåŠ¨åˆ°è®¤è¯åŒºåŸŸ
                    authSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    return;
                }
                
                // æ·»åŠ è®¤è¯å¤´åˆ°è¡¨å•æäº¤
                const formData = new FormData(this);
                const xhr = new XMLHttpRequest();
                xhr.open('POST', '/upload');
                xhr.setRequestHeader('Authorization', authCache.authHeader);
                
                // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                const submitBtn = this.querySelector('button[type="submit"]');
                const originalText = submitBtn.textContent;
                submitBtn.disabled = true;
                submitBtn.textContent = langPack.uploading;
                
                xhr.onload = function() {
                    submitBtn.disabled = false;
                    submitBtn.textContent = originalText;
                    
                    if (xhr.status === 200) {
                        // ä¸Šä¼ æˆåŠŸ
                        try {
                            const response = JSON.parse(xhr.responseText);
                            showMessage(response.message || langPack.uploadSuccess, 'success');
                            
                            // é‡ç½®è¡¨å•
                            uploadForm.reset();
                            fileInfo.style.display = 'none';
                            
                            // é‡æ–°åŠ è½½æ–‡ä»¶åˆ—è¡¨
                            loadFileList();
                        } catch (e) {
                            showMessage(langPack.uploadSuccessButParseFailed, 'success');
                            loadFileList();
                        }
                    } else if (xhr.status === 401) {
                        // è®¤è¯å¤±è´¥
                        showMessage(langPack.authFailedPleaseLogin, 'error');
                        authCache.isAuthenticated = false;
                        localStorage.removeItem('put-fileAuth');
                        updateAuthStatus();
                        // æ»šåŠ¨åˆ°è®¤è¯åŒºåŸŸ
                        authSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    } else {
                        // å…¶ä»–é”™è¯¯
                        let errorMsg = langPack.uploadFailed;
                        try {
                            const response = JSON.parse(xhr.responseText);
                            errorMsg = response.message || errorMsg;
                        } catch (e) {
                            errorMsg += ': ' + xhr.statusText;
                        }
                        showMessage(errorMsg, 'error');
                    }
                };
                
                xhr.onerror = function() {
                    submitBtn.disabled = false;
                    submitBtn.textContent = originalText;
                    showMessage(langPack.networkErrorPleaseRetry, 'error');
                };
                
                xhr.send(formData);
                e.preventDefault(); // é˜²æ­¢é»˜è®¤æäº¤
            });
            
            // åŠ è½½æ–‡ä»¶åˆ—è¡¨
            function loadFileList() {
                const fileTable = document.getElementById('file-table');
                const fileListBody = document.getElementById('file-list-body');
                const noFiles = document.getElementById('no-files');
                const loadingIndicator = document.getElementById('loading-indicator');
                const notAuthenticated = document.getElementById('not-authenticated');
                
                // æ˜¾ç¤ºåŠ è½½æŒ‡ç¤ºå™¨
                loadingIndicator.style.display = 'block';
                fileTable.style.display = 'none';
                noFiles.style.display = 'none';
                if (notAuthenticated) {
                    notAuthenticated.style.display = 'none';
                }
                
                // æ¸…ç©ºæ–‡ä»¶åˆ—è¡¨
                fileListBody.innerHTML = '';
                
                // æ£€æŸ¥è®¤è¯çŠ¶æ€
                if (!authCache.isAuthenticated) {
                    loadingIndicator.style.display = 'none';
                    // åˆ›å»ºæˆ–æ˜¾ç¤ºæœªè®¤è¯æç¤º
                    let notAuthElement = document.getElementById('not-authenticated');
                    if (!notAuthElement) {
                        notAuthElement = document.createElement('div');
                        notAuthElement.id = 'not-authenticated';
                        notAuthElement.style.textAlign = 'center';
                        notAuthElement.style.padding = '30px';
                        notAuthElement.style.color = getComputedStyle(document.documentElement).getPropertyValue('--text-light').trim();
                        notAuthElement.innerHTML = `
                            <div style="font-size: 2rem; margin-bottom: 15px;">ğŸ”’</div>
                            <p style="margin-bottom: 10px;">${langPack.pleaseAuthenticateToViewFiles}</p>
                            <p style="font-size: 0.9rem;">${langPack.username}: admin<br>${langPack.password}: admin123</p>
                        `;
                        fileListBody.parentNode.insertBefore(notAuthElement, fileListBody);
                    } else {
                        // ç¡®ä¿æç¤ºå†…å®¹æ˜¯å½“å‰è¯­è¨€
                        notAuthElement.innerHTML = `
                            <div style="font-size: 2rem; margin-bottom: 15px;">ğŸ”’</div>
                            <p style="margin-bottom: 10px;">${langPack.pleaseAuthenticateToViewFiles}</p>
                            <p style="font-size: 0.9rem;">${langPack.username}: admin<br>${langPack.password}: admin123</p>
                        `;
                        notAuthElement.style.display = 'block';
                    }
                    showMessage(langPack.pleaseAuthenticateFirst, 'error');
                    return;
                }
                
                // è·å–è®¤è¯å¤´
                const authHeader = getAuthHeader();
                if (!authHeader) {
                    loadingIndicator.style.display = 'none';
                    showMessage(langPack.invalidAuthPleaseLogin, 'error');
                    return;
                }
                
                // è¯·æ±‚æ–‡ä»¶åˆ—è¡¨
                fetch('/api/files', {
                    headers: {
                        'Authorization': authHeader
                    }
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTPé”™è¯¯!çŠ¶æ€: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    loadingIndicator.style.display = 'none';
                    
                    // æ£€æŸ¥APIå“åº”æ˜¯å¦æˆåŠŸ
                    if (!data.success) {
                        throw new Error(data.message || langPack.fetchFileListFailed);
                    }
                    
                    // ä»å“åº”ä¸­è·å–æ–‡ä»¶åˆ—è¡¨æ•°æ®
                    const files = data.data || [];
                    
                    // æŒ‰åˆ›å»ºæ—¶é—´æ’åºï¼ˆæœ€æ–°çš„åœ¨å‰ï¼‰
                    files.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
                    
                    if (files.length > 0) {
                        // æ˜¾ç¤ºæ–‡ä»¶è¡¨
                        fileTable.style.display = 'table';
                        
                        // ç”Ÿæˆæ–‡ä»¶åˆ—è¡¨HTML
                        files.forEach(file => {
                            const fileSize = formatFileSize(file.size);
                            const fileTime = formatDateTime(file.created_at);
                            
                            // åˆ›å»ºè¡¨æ ¼è¡Œ
                            const row = document.createElement('tr');
                            row.className = 'file-row';
                            // ä½¿ç”¨langPackå˜é‡è·å–æŒ‰é’®æ–‡æœ¬
                            const openBtnText = langPack.openBtn;
                            const deleteBtnText = langPack.deleteBtn;
                            
                            row.innerHTML = `
                                <td style="padding: 10px; border-bottom: 1px solid var(--border-color);">
                                    <div style="display: flex; align-items: center;">
                                        <span class="file-icon">ğŸ“„</span>
                                        <span style="margin-left: 8px;">${escapeHTML(file.name)}</span>
                                    </div>
                                </td>
                                <td style="padding: 10px; text-align: right; border-bottom: 1px solid var(--border-color);">
                                    ${fileSize}
                                </td>
                                <td style="padding: 10px; text-align: left; border-bottom: 1px solid var(--border-color);">
                                    ${fileTime}
                                </td>
                                <td style="padding: 10px; text-align: center; border-bottom: 1px solid var(--border-color);">
                                    <button class="open-btn" data-file="${escapeHTML(file.name)}" style="margin-right: 5px; padding: 5px 10px; background-color: var(--primary-color); color: white; border: none; border-radius: 3px; cursor: pointer;">${openBtnText}</button>
                                    <button class="delete-btn" data-file="${escapeHTML(file.name)}" style="padding: 5px 10px; background-color: #f44336; color: white; border: none; border-radius: 3px; cursor: pointer;">${deleteBtnText}</button>
                                </td>
                            `;
                            
                            // æ·»åŠ æ‚¬åœæ•ˆæœ
                            row.addEventListener('mouseenter', function() {
                                this.style.backgroundColor = 'rgba(67, 97, 238, 0.03)';
                            });
                            
                            row.addEventListener('mouseleave', function() {
                                this.style.backgroundColor = '';
                            });
                            
                            fileListBody.appendChild(row);
                        });
                    } else {
                        // æ˜¾ç¤ºæ— æ–‡ä»¶æç¤º
                        noFiles.style.display = 'block';
                    }
                })
                .catch(error => {
                    loadingIndicator.style.display = 'none';
                    showMessage(langPack.loadFileListFailed + ': ' + error.message, 'error');
                });
            }
            
            // è·å–è®¤è¯å¤´
            function getAuthHeader() {
                if (!authCache.isAuthenticated) {
                    return null;
                }
                
                // æ£€æŸ¥è®¤è¯æ˜¯å¦è¿‡æœŸ
                const now = new Date().getTime();
                if (now - authCache.lastAuthenticated > 24 * 60 * 60 * 1000) {
                    authCache.isAuthenticated = false;
                    localStorage.removeItem('put-fileAuth');
                    updateAuthStatus();
                    return null;
                }
                
                return authCache.authHeader;
            }
            
            // æ‰“å¼€æ–‡ä»¶
            function openFile(fileName) {
                const authHeader = getAuthHeader();
                if (!authHeader) {
                    showMessage('è¯·å…ˆè¿›è¡Œè®¤è¯', 'error');
                    return;
                }
                
                // åˆ›å»ºä¸´æ—¶è¡¨å•å¹¶æäº¤ä»¥æ‰“å¼€æ–‡ä»¶
                const form = document.createElement('form');
                form.method = 'GET';
                form.action = '/files/' + encodeURIComponent(fileName);
                
                // æ·»åŠ è®¤è¯å¤´ä¿¡æ¯
                const authInput = document.createElement('input');
                authInput.type = 'hidden';
                authInput.name = 'auth';
                authInput.value = authHeader;
                form.appendChild(authInput);
                
                document.body.appendChild(form);
                form.submit();
            }
            
            // åˆ é™¤æ–‡ä»¶
            function deleteFile(fileName) {
                if (!confirm(langPack.confirmDeleteFile.replace('{fileName}', fileName))) {
                    return;
                }
                
                const authHeader = getAuthHeader();
                if (!authHeader) {
                    showMessage(langPack.pleaseAuthenticateFirst, 'error');
                    return;
                }
                
                fetch('/api/files/' + encodeURIComponent(fileName), {
                    method: 'DELETE',
                    headers: {
                        'Authorization': authHeader,
                        'Content-Type': 'application/json'
                    }
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTPé”™è¯¯!çŠ¶æ€: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    showMessage(data.message || langPack.fileDeleteSuccess, 'success');
                    // é‡æ–°åŠ è½½æ–‡ä»¶åˆ—è¡¨
                    loadFileList();
                })
                .catch(error => {
                    showMessage(langPack.fileDeleteFailed + ': ' + error.message, 'error');
                });
            }
            
            // æ ¼å¼åŒ–æ–‡ä»¶å¤§å°
            function formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }
            
            // æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´
            function formatDateTime(dateString) {
                const date = new Date(dateString);
                const now = new Date();
                const diffTime = Math.abs(now - date);
                const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                
                // è·å–å½“å‰è¯­è¨€çš„locale
                const locale = currentLang === 'en' ? 'en-US' : 'zh-CN';
                
                // ä»Šå¤©çš„æ–‡ä»¶æ˜¾ç¤ºæ—¶é—´
                if (diffDays === 0) {
                    return date.toLocaleTimeString(locale, { hour: '2-digit', minute: '2-digit' });
                }
                // æ˜¨å¤©çš„æ–‡ä»¶æ˜¾ç¤º"æ˜¨å¤©/Yesterday HH:MM"
                else if (diffDays === 1) {
                    return langPack.yesterday + ' ' + 
                           date.toLocaleTimeString(locale, { hour: '2-digit', minute: '2-digit' });
                }
                // ä»Šå¹´çš„æ–‡ä»¶æ˜¾ç¤º"MM-DD HH:MM"
                else if (date.getFullYear() === now.getFullYear()) {
                    return date.toLocaleDateString(locale, { month: '2-digit', day: '2-digit' }) + ' ' + 
                           date.toLocaleTimeString(locale, { hour: '2-digit', minute: '2-digit' });
                }
                // å…¶ä»–æ˜¾ç¤ºå®Œæ•´æ—¥æœŸ"YYYY-MM-DD HH:MM"
                else {
                    return date.toLocaleDateString(locale, { year: 'numeric', month: '2-digit', day: '2-digit' }) + ' ' + 
                           date.toLocaleTimeString(locale, { hour: '2-digit', minute: '2-digit' });
                }
            }
            
            // HTMLè½¬ä¹‰å‡½æ•°ï¼Œé˜²æ­¢XSSæ”»å‡»
            function escapeHTML(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
            
            // æ¶ˆæ¯æ˜¾ç¤ºå‡½æ•°
            function showMessage(message, type = 'info') {
                // åˆ›å»ºæ¶ˆæ¯å®¹å™¨
                let messageContainer = document.getElementById('message-container');
                if (!messageContainer) {
                    messageContainer = document.createElement('div');
                    messageContainer.id = 'message-container';
                    messageContainer.style.position = 'fixed';
                    messageContainer.style.top = '20px';
                    messageContainer.style.right = '20px';
                    messageContainer.style.zIndex = '1000';
                    messageContainer.style.maxWidth = '400px';
                    document.body.appendChild(messageContainer);
                }
                
                // åˆ›å»ºæ¶ˆæ¯å…ƒç´ 
                const messageElement = document.createElement('div');
                messageElement.className = 'message notification';
                
                // è®¾ç½®æ¶ˆæ¯æ ·å¼
                let bgColor, textColor;
                switch(type) {
                    case 'success':
                        bgColor = '#4caf50';
                        textColor = 'white';
                        break;
                    case 'error':
                        bgColor = '#f44336';
                        textColor = 'white';
                        break;
                    case 'warning':
                        bgColor = '#ff9800';
                        textColor = 'white';
                        break;
                    default:
                        bgColor = '#2196f3';
                        textColor = 'white';
                }
                
                messageElement.style.backgroundColor = bgColor;
                messageElement.style.color = textColor;
                messageElement.style.padding = '12px 16px';
                messageElement.style.borderRadius = '4px';
                messageElement.style.marginBottom = '8px';
                messageElement.style.boxShadow = '0 2px 5px rgba(0, 0, 0, 0.2)';
                messageElement.style.fontSize = '14px';
                messageElement.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
                messageElement.style.opacity = '0';
                messageElement.style.transform = 'translateX(20px)';
                messageElement.style.wordWrap = 'break-word';
                
                // è®¾ç½®æ¶ˆæ¯å†…å®¹
                messageElement.textContent = message;
                
                // æ·»åŠ åˆ°å®¹å™¨
                messageContainer.appendChild(messageElement);
                // å¦‚æœæ˜¯é”™è¯¯ç±»å‹ï¼ŒåŒæ—¶æŠŠé”™è¯¯ä¿¡æ¯å†™å…¥è®¤è¯çŠ¶æ€åŒºåŸŸçš„ #status-textï¼Œä¾¿äºç”¨æˆ·åœ¨é¡µé¢ä¸Šçœ‹åˆ°æ˜ç¡®çš„é”™è¯¯åŸå› ã€‚
                // ä¿å­˜ä¹‹å‰çš„çŠ¶æ€æ–‡æœ¬ï¼Œ5ç§’åæ¢å¤ï¼ˆä»…å½“è¯¥çŠ¶æ€æœªè¢«å…¶ä»–æ“ä½œè¦†ç›–æ—¶æ¢å¤ï¼‰ã€‚
                if (type === 'error') {
                    try {
                        const statusEl = document.getElementById('status-text');
                        if (statusEl) {
                            const previousStatus = statusEl.textContent;
                            // æ ‡è®°ä¸ºä¸´æ—¶çŠ¶æ€ï¼Œé¿å…å…¶ä»–å‡½æ•°ï¼ˆå¦‚ updateAuthStatusï¼‰è¦†ç›–
                            statusEl.dataset.temp = 'true';
                            statusEl.textContent = message;
                            // åœ¨5ç§’åæ¢å¤ä¹‹å‰çš„çŠ¶æ€ï¼Œä»…å½“å½“å‰ä»ä¸ºæˆ‘ä»¬çš„é”™è¯¯ä¿¡æ¯æ—¶æ¢å¤
                            setTimeout(() => {
                                try {
                                    if (statusEl && statusEl.textContent === message) {
                                        statusEl.textContent = previousStatus;
                                    }
                                    // æ¸…é™¤ä¸´æ—¶æ ‡è®°
                                    delete statusEl.dataset.temp;
                                } catch (innerErr) {
                                    // å¿½ç•¥æ¢å¤æ—¶çš„é”™è¯¯
                                }
                            }, 5000);
                        }
                    } catch (e) {
                        // å¿½ç•¥ä»»ä½•ä¸çŠ¶æ€å†™å…¥ç›¸å…³çš„é”™è¯¯
                        console.error('æ›´æ–°çŠ¶æ€æ–‡æœ¬å¤±è´¥:', e);
                    }
                }
                
                // æ˜¾ç¤ºæ¶ˆæ¯ï¼ˆåŠ¨ç”»ï¼‰
                setTimeout(() => {
                    messageElement.style.opacity = '1';
                    messageElement.style.transform = 'translateX(0)';
                }, 10);
                
                // 3ç§’åè‡ªåŠ¨éšè—
                setTimeout(() => {
                    messageElement.style.opacity = '0';
                    messageElement.style.transform = 'translateX(20px)';
                    
                    // åŠ¨ç”»ç»“æŸåç§»é™¤å…ƒç´ 
                    setTimeout(() => {
                        if (messageContainer.contains(messageElement)) {
                            messageContainer.removeChild(messageElement);
                        }
                        
                        // å¦‚æœå®¹å™¨ä¸ºç©ºï¼Œç§»é™¤å®¹å™¨
                        if (messageContainer.children.length === 0) {
                            document.body.removeChild(messageContainer);
                        }
                    }, 300);
                }, 3000);
            }
            
            // æ·»åŠ æ–‡ä»¶è¡Œæ‚¬åœæ ·å¼
            const style = document.createElement('style');
            style.textContent = `
                .file-row {
                    transition: background-color 0.2s ease;
                }
                .delete-btn:hover {
                    background-color: #d32f2f !important;
                }
            `;
            document.head.appendChild(style);
            
            // æ£€æŸ¥URLå‚æ•°ä¸­çš„çŠ¶æ€æ¶ˆæ¯
            const urlParams = new URLSearchParams(window.location.search);
            const status = urlParams.get('status');
            const message = urlParams.get('message');
            if (status && message) {
                showMessage(decodeURIComponent(message), status);
            }
            
            // åˆå§‹åŒ–æ—¶åŠ è½½æ–‡ä»¶åˆ—è¡¨
            // ä½†åªæœ‰åœ¨ç”¨æˆ·å·²è®¤è¯çš„æƒ…å†µä¸‹æ‰åŠ è½½
            if (authCache.isAuthenticated) {
                loadFileList();
            }
            
            // ç»‘å®šæ–‡ä»¶æ“ä½œäº‹ä»¶ï¼ˆä½¿ç”¨äº‹ä»¶å§”æ‰˜ï¼‰
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('open-btn')) {
                    const fileName = e.target.getAttribute('data-file');
                    openFile(fileName);
                } else if (e.target.classList.contains('delete-btn')) {
                    const fileName = e.target.getAttribute('data-file');
                    deleteFile(fileName);
                }
            });
        });
    </script>
</body>
</html>